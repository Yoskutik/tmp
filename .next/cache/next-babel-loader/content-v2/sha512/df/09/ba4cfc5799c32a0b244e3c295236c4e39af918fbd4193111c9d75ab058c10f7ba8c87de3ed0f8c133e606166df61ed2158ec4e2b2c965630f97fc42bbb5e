{"ast":null,"code":"import { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport React from 'react';\nimport { FetchRequest } from '@utils';\nimport { BlogItem, SearchField, Pager } from '@views/blog';\nimport blog from '@data/blog.json';\nimport { Container, MainLayout } from '@components';\nimport styles from '@sass/pages/blog/BlogPage.module.scss';\nconst title = 'Фотограф в Санкт-Петербурге | Мельникова Татьяна | Личный блог';\nconst description = '...';\nconst keywords = '...';\n\nconst BlogPage = ({\n  items,\n  maxPage\n}) => /*#__PURE__*/_jsx(MainLayout, {\n  title: title,\n  description: description,\n  keywords: keywords,\n  children: /*#__PURE__*/_jsxs(Container, {\n    cls: styles.container,\n    children: [/*#__PURE__*/_jsx(SearchField, {\n      cls: styles.search\n    }), items.map(it => /*#__PURE__*/_jsx(BlogItem, {\n      item: it\n    }, it.title)), /*#__PURE__*/_jsx(Pager, {\n      maxPage: maxPage\n    })]\n  })\n});\n\nexport default BlogPage;\nexport const getServerSideProps = async ({\n  query\n}) => {\n  const page = +(query.page || 1);\n  let initialBlogs;\n\n  if (query.query) {\n    const titles = await new FetchRequest({\n      url: '/blog/search',\n      params: {\n        query: query.query\n      }\n    }).request();\n    initialBlogs = blog.filter(it => titles.includes(it.title));\n  } else if (query.keyword) {\n    const titles = await new FetchRequest({\n      url: '/blog/search',\n      params: {\n        keyword: query.keyword\n      }\n    }).request();\n    initialBlogs = blog.filter(it => titles.includes(it.title));\n  } else {\n    initialBlogs = blog;\n  }\n\n  const items = initialBlogs.map(it => {\n    const newIt = _objectSpread({}, it);\n\n    const arr = [];\n    const words = newIt.body[0].split(' ');\n    let length = 0;\n\n    for (let i = 0; i < words.length; i++) {\n      length += words[i].length + 1;\n      arr.push(words[i]);\n      if (length >= 128) break;\n    }\n\n    newIt.body = [arr.join(' ')];\n    return newIt;\n  });\n  return {\n    props: {\n      items: items.slice((page - 1) * 4, page * 4),\n      maxPage: Math.ceil(items.length / 4)\n    }\n  };\n};","map":null,"metadata":{},"sourceType":"module"}