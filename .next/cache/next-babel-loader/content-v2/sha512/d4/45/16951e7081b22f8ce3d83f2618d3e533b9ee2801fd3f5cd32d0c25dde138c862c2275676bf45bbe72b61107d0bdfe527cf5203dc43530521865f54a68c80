{"ast":null,"code":"import { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport _regeneratorRuntime from \"C:/Users/Yoskutik/Desktop/MyInspire-ph.ru-v4/node_modules/next/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"C:/Users/Yoskutik/Desktop/MyInspire-ph.ru-v4/node_modules/next/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport React, { useCallback, useEffect, useRef, useState } from 'react';\nimport { $, useEventListener } from '@utils';\nimport { Picture } from '@components';\nimport { ArrowIcon, FullScreenCloseIcon, FullScreenOpenIcon } from '@components/icons';\nimport styles from '@sass/pages/portfolio/Gallery.module.scss';\nimport { scrollTo } from './betterScroll';\nvar lastClickedIndexInLocking = null;\nvar touchStartX;\nexport var Gallery = function Gallery(_ref) {\n  var photos = _ref.photos,\n      onClose = _ref.onClose;\n\n  var _useState = useState(0),\n      mainIndex = _useState[0],\n      setMainIndex = _useState[1];\n\n  var _useState2 = useState(0),\n      lastIndex = _useState2[0],\n      setLastIndex = _useState2[1];\n\n  var _useState3 = useState(null),\n      picStyle = _useState3[0],\n      setPicStyle = _useState3[1];\n\n  var _useState4 = useState(false),\n      locked = _useState4[0],\n      setLocked = _useState4[1];\n\n  var _useState5 = useState(false),\n      fullScreenOpened = _useState5[0],\n      setFullScreenOpened = _useState5[1];\n\n  var ref = useRef();\n  useEffect(function () {\n    document.body.style.overflow = 'hidden';\n    window.location.hash = 'gallery';\n    return function () {\n      document.body.style.overflow = null;\n    };\n  });\n  useEventListener(globalThis, 'hashchange', function () {\n    if (window.location.hash === '') onClose();\n  }, false);\n  var openFullScreen = useCallback( /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            _context.next = 2;\n            return document.body.requestFullscreen();\n\n          case 2:\n            setFullScreenOpened(true);\n\n          case 3:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee);\n  })), []);\n  var closeFullScreen = useCallback( /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n    return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            _context2.next = 2;\n            return document.exitFullscreen();\n\n          case 2:\n            setFullScreenOpened(false);\n\n          case 3:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, _callee2);\n  })), []);\n\n  var chooseImage = function chooseImage(index) {\n    var changeLastIndex = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;\n\n    if (locked) {\n      lastClickedIndexInLocking = index;\n      return;\n    }\n\n    var boundedIndex = index > 0 ? index : photos.length - 1;\n    boundedIndex = boundedIndex < photos.length ? boundedIndex : 0;\n    var el = ref.current;\n    var scrollSize = window.innerWidth > 767 ? (el.scrollHeight - el.clientHeight + 50) / photos.length : (el.scrollWidth - el.clientWidth + 40) / photos.length;\n    changeLastIndex && setLastIndex(mainIndex);\n    setMainIndex(boundedIndex);\n    setLocked(true);\n    setPicStyle({\n      left: boundedIndex < mainIndex ? '-100%' : 0\n    });\n    scrollTo(ref.current, boundedIndex * scrollSize, {\n      direction: window.innerWidth > 767 ? 'vertical' : 'horizontal'\n    });\n    setTimeout(function () {\n      setPicStyle({\n        left: boundedIndex < mainIndex ? 0 : '-100%'\n      });\n\n      var onAnimationEnd = function onAnimationEnd() {\n        setLastIndex(boundedIndex);\n        setPicStyle(null);\n        setLocked(false);\n        $(\".\".concat(styles.mainContainer, \" picture\")).removeEventListener('transitionend', onAnimationEnd);\n\n        if (lastClickedIndexInLocking !== null) {\n          setTimeout(function () {\n            var i = lastClickedIndexInLocking;\n            lastClickedIndexInLocking = null;\n            chooseImage(i, false);\n          });\n        }\n      };\n\n      $(\".\".concat(styles.mainContainer, \" picture\")).addEventListener('transitionend', onAnimationEnd);\n    });\n  };\n\n  var choosePrev = function choosePrev() {\n    return chooseImage(mainIndex - 1);\n  };\n\n  var chooseNext = function chooseNext() {\n    return chooseImage(mainIndex + 1);\n  };\n\n  var onTouchStart = function onTouchStart(evt) {\n    return touchStartX = evt.touches[0].clientX;\n  };\n\n  var onTouchEnd = function onTouchEnd(evt) {\n    var diff = evt.changedTouches[0].clientX - touchStartX;\n    touchStartX = null;\n    if (Math.abs(diff) < 20) return;\n    diff > 0 ? choosePrev() : chooseNext();\n  };\n\n  return /*#__PURE__*/_jsxs(\"div\", {\n    className: styles.gallery,\n    children: [/*#__PURE__*/_jsx(\"div\", {\n      className: styles.thumbnailsContainer,\n      ref: ref,\n      children: photos.map(function (it, i) {\n        return /*#__PURE__*/_jsx(Picture, {\n          src: \"/photos/portfolio/gallery/\".concat(it, \"m.jpg\"),\n          onClick: function onClick() {\n            return chooseImage(i);\n          },\n          imgCls: \"\".concat(styles.thumbnail, \" \").concat(i === mainIndex ? styles.active : '')\n        }, it);\n      })\n    }), /*#__PURE__*/_jsxs(\"div\", {\n      className: styles.mainContainer,\n      onTouchStart: onTouchStart,\n      onTouchEnd: onTouchEnd,\n      children: [lastIndex > mainIndex && /*#__PURE__*/_jsxs(_Fragment, {\n        children: [/*#__PURE__*/_jsx(Picture, {\n          src: \"/photos/portfolio/gallery/\".concat(photos[mainIndex], \".jpg\"),\n          imgCls: styles.mainPhoto,\n          style: picStyle\n        }), /*#__PURE__*/_jsx(Picture, {\n          src: \"/photos/portfolio/gallery/\".concat(photos[lastIndex], \".jpg\"),\n          imgCls: styles.mainPhoto,\n          style: picStyle\n        })]\n      }), lastIndex < mainIndex && /*#__PURE__*/_jsxs(_Fragment, {\n        children: [/*#__PURE__*/_jsx(Picture, {\n          src: \"/photos/portfolio/gallery/\".concat(photos[lastIndex], \".jpg\"),\n          imgCls: styles.mainPhoto,\n          style: picStyle\n        }), /*#__PURE__*/_jsx(Picture, {\n          src: \"/photos/portfolio/gallery/\".concat(photos[mainIndex], \".jpg\"),\n          imgCls: styles.mainPhoto,\n          style: picStyle\n        })]\n      }), lastIndex === mainIndex && /*#__PURE__*/_jsx(Picture, {\n        src: \"/photos/portfolio/gallery/\".concat(photos[mainIndex], \".jpg\"),\n        imgCls: styles.mainPhoto\n      }), /*#__PURE__*/_jsx(\"button\", {\n        className: \"\".concat(styles.button, \" \").concat(styles.left),\n        onClick: choosePrev,\n        children: /*#__PURE__*/_jsx(ArrowIcon, {\n          size: 64\n        })\n      }), /*#__PURE__*/_jsx(\"button\", {\n        className: \"\".concat(styles.button, \" \").concat(styles.right),\n        onClick: chooseNext,\n        children: /*#__PURE__*/_jsx(ArrowIcon, {\n          size: 64\n        })\n      }), fullScreenOpened ? /*#__PURE__*/_jsx(\"button\", {\n        className: \"\".concat(styles.button, \" \").concat(styles.fullscreen),\n        onClick: closeFullScreen,\n        children: /*#__PURE__*/_jsx(FullScreenCloseIcon, {\n          size: 32\n        })\n      }) : /*#__PURE__*/_jsx(\"button\", {\n        className: \"\".concat(styles.button, \" \").concat(styles.fullscreen),\n        onClick: openFullScreen,\n        children: /*#__PURE__*/_jsx(FullScreenOpenIcon, {\n          size: 32\n        })\n      })]\n    }), /*#__PURE__*/_jsx(\"button\", {\n      className: styles.close,\n      onClick: function onClick() {\n        return window.history.back();\n      },\n      type: \"button\",\n      children: \"\\xD7\"\n    })]\n  });\n};","map":null,"metadata":{},"sourceType":"module"}