{"ast":null,"code":"import fs from 'fs';\nimport getConfig from 'next/config';\nimport glob from 'glob';\nconst {\n  serverRuntimeConfig\n} = getConfig();\nconst {\n  rootDir\n} = serverRuntimeConfig;\nconst pathsMap = {};\nexport const getPhotos = path => {\n  if (path in pathsMap) return pathsMap[path];\n  const newPaths = glob.sync(`${rootDir}/public/photos${path}**/*.jpg`).map(it => it.replace(`${rootDir}/public/photos${path}`, '').replace(/\\.jpg$/i, ''));\n  pathsMap[path] = newPaths;\n  return newPaths;\n};\n\nif (!fs.existsSync(`${rootDir}/statistics`)) {\n  fs.mkdirSync(`${rootDir}/statistics`);\n}\n\nconst postVisitorsPath = `${rootDir}/statistics/postVisitors.json`;\nlet postVisitors;\n\ntry {\n  postVisitors = JSON.parse(fs.readdirSync(postVisitorsPath, 'utf-8').join(''));\n} catch {\n  postVisitors = {};\n}\n\nsetInterval(() => {\n  try {\n    fs.writeFileSync(postVisitorsPath, JSON.stringify(postVisitors), {\n      encoding: 'utf-8'\n    });\n  } catch {\n    /* */\n  }\n}, 5 * 60 * 1000);\nexport const addPostVisitor = title => {\n  if (title in postVisitors) {\n    postVisitors[title]++;\n  } else {\n    postVisitors[title] = 1;\n  }\n};","map":null,"metadata":{},"sourceType":"module"}